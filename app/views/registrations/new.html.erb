<%= simple_form_for [@competition, @registration] do |f| %>
  <%= f.simple_fields_for :competitor_attributes, @registration.competitor do |competitor_form| %>
    <%= competitor_form.input :wca_id, :label => "WCA ID" %>
    <%= competitor_form.input :first_name %>
    <%= competitor_form.input :last_name %>
    <%= competitor_form.input :gender, :collection => [["Male", "m"], ["Female", "f"]], :as => :radio %>
    <%= competitor_form.input :date_of_birth, :as => :date, :start_year => Date.today.year - 120, :end_year => Date.today.year %>
  <% end %>

  <% @competition.days.each_with_index do |day, index| %>
    <div class="day<%= index %>">
      <p>
        <%= label_tag "registration_days_as_guest_#{index}", "Guest on #{l(day, :format => :day)}" %>
        <%= check_box_tag "registration[days_as_guest][]", index, @registration.days_as_guest.include?(index), :id => "registration_days_as_guest_#{index}" %>
      </p>
      <% @competition.schedules.registerable.for(index).each do |schedule| %>
        <p>
          <%= label_tag "registration_schedule_ids_#{schedule.id}", schedule.event.name %>
          <%= check_box_tag "registration[schedule_ids][]", schedule.id, @registration.schedules.map(&:id).include?(schedule.id), :id => "registration_schedule_ids_#{schedule.id}" %>
        </p>
      <% end %>
    </div>
  <% end %>

  <%= f.input :email %>
  <%= f.submit "Register" %>
<% end %>